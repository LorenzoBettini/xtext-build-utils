/*
 * generated by Xtext 2.20.0
 */
package io.github.lorenzobettini.tychoxbasetestlanguage.tests

import com.google.inject.Inject
import org.eclipse.xtext.testing.InjectWith
import org.eclipse.xtext.testing.XtextRunner
import org.eclipse.xtext.xbase.lib.util.ReflectExtensions
import org.eclipse.xtext.xbase.testing.CompilationTestHelper
import org.eclipse.xtext.xbase.testing.TemporaryFolder
import static org.junit.Assert.assertEquals
import org.junit.Rule
import org.junit.Test
import org.junit.runner.RunWith

@RunWith(XtextRunner)
@InjectWith(TychoxbasetestlanguageInjectorProvider)
class TychoxbasetestlanguageCompilerTest {
	@Rule
	@Inject public TemporaryFolder temporaryFolder
	@Inject extension CompilationTestHelper
	@Inject extension ReflectExtensions
	
	@Test
	def void compileModel() {
		'''
			Hello Xtext {
				val String s = "hello"
				return s.toFirstUpper
			}
		'''.compile[
			assertEquals('''
				package example;
				
				import org.eclipse.xtext.xbase.lib.StringExtensions;
				
				@SuppressWarnings("all")
				public class Xtext {
				  @Override
				  public String toString() {
				    final String s = "hello";
				    return StringExtensions.toFirstUpper(s);
				  }
				}
			'''.toString, getSingleGeneratedCode
			)
			// make sure it compiles in Java
			val obj = it.compiledClass.getDeclaredConstructor().newInstance
			assertEquals("Hello", obj.invoke('toString'))
		]
	}
}
